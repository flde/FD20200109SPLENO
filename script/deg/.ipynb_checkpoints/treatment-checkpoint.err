[NbConvertApp] Converting notebook treatment.r.ipynb to html
Traceback (most recent call last):
  File "/home/fdeckert/bin/miniconda3/bin/jupyter-nbconvert", line 11, in <module>
    sys.exit(main())
  File "/home/fdeckert/bin/miniconda3/lib/python3.8/site-packages/jupyter_core/application.py", line 264, in launch_instance
    return super(JupyterApp, cls).launch_instance(argv=argv, **kwargs)
  File "/home/fdeckert/bin/miniconda3/lib/python3.8/site-packages/traitlets/config/application.py", line 846, in launch_instance
    app.start()
  File "/home/fdeckert/bin/miniconda3/lib/python3.8/site-packages/nbconvert/nbconvertapp.py", line 346, in start
    self.convert_notebooks()
  File "/home/fdeckert/bin/miniconda3/lib/python3.8/site-packages/nbconvert/nbconvertapp.py", line 518, in convert_notebooks
    self.convert_single_notebook(notebook_filename)
  File "/home/fdeckert/bin/miniconda3/lib/python3.8/site-packages/nbconvert/nbconvertapp.py", line 483, in convert_single_notebook
    output, resources = self.export_single_notebook(notebook_filename, resources, input_buffer=input_buffer)
  File "/home/fdeckert/bin/miniconda3/lib/python3.8/site-packages/nbconvert/nbconvertapp.py", line 412, in export_single_notebook
    output, resources = self.exporter.from_filename(notebook_filename, resources=resources)
  File "/home/fdeckert/bin/miniconda3/lib/python3.8/site-packages/nbconvert/exporters/exporter.py", line 181, in from_filename
    return self.from_file(f, resources=resources, **kw)
  File "/home/fdeckert/bin/miniconda3/lib/python3.8/site-packages/nbconvert/exporters/exporter.py", line 199, in from_file
    return self.from_notebook_node(nbformat.read(file_stream, as_version=4), resources=resources, **kw)
  File "/home/fdeckert/bin/miniconda3/lib/python3.8/site-packages/nbconvert/exporters/html.py", line 129, in from_notebook_node
    return super().from_notebook_node(nb, resources, **kw)
  File "/home/fdeckert/bin/miniconda3/lib/python3.8/site-packages/nbconvert/exporters/templateexporter.py", line 374, in from_notebook_node
    nb_copy, resources = super().from_notebook_node(nb, resources, **kw)
  File "/home/fdeckert/bin/miniconda3/lib/python3.8/site-packages/nbconvert/exporters/exporter.py", line 143, in from_notebook_node
    nb_copy, resources = self._preprocess(nb_copy, resources)
  File "/home/fdeckert/bin/miniconda3/lib/python3.8/site-packages/nbconvert/exporters/exporter.py", line 318, in _preprocess
    nbc, resc = preprocessor(nbc, resc)
  File "/home/fdeckert/bin/miniconda3/lib/python3.8/site-packages/nbconvert/preprocessors/base.py", line 47, in __call__
    return self.preprocess(nb, resources)
  File "/home/fdeckert/bin/miniconda3/lib/python3.8/site-packages/nbconvert/preprocessors/execute.py", line 84, in preprocess
    self.preprocess_cell(cell, resources, index)
  File "/home/fdeckert/bin/miniconda3/lib/python3.8/site-packages/nbconvert/preprocessors/execute.py", line 105, in preprocess_cell
    cell = self.execute_cell(cell, index, store_history=True)
  File "/home/fdeckert/bin/miniconda3/lib/python3.8/site-packages/nbclient/util.py", line 74, in wrapped
    return just_run(coro(*args, **kwargs))
  File "/home/fdeckert/bin/miniconda3/lib/python3.8/site-packages/nbclient/util.py", line 53, in just_run
    return loop.run_until_complete(coro)
  File "/home/fdeckert/bin/miniconda3/lib/python3.8/asyncio/base_events.py", line 616, in run_until_complete
    return future.result()
  File "/home/fdeckert/bin/miniconda3/lib/python3.8/site-packages/nbclient/client.py", line 857, in async_execute_cell
    self._check_raise_for_error(cell, exec_reply)
  File "/home/fdeckert/bin/miniconda3/lib/python3.8/site-packages/nbclient/client.py", line 760, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
write.xlsx(deg, file="result/treatment_deg/treatment_deg.xlsx", overwrite=TRUE)
------------------

Error in (function (wb, sheetName, gridLines = openxlsx_getOp("gridLines", : A worksheet by the name 'cluster_NA' already exists! Sheet names must be unique case-insensitive.
Traceback:

1. write.xlsx(deg, file = "result/treatment_deg/treatment_deg.xlsx", 
 .     overwrite = TRUE)
2. buildWorkbook(x, asTable = asTable, ...)
3. do_call_params(addWorksheet, params, wb = list(wb), .map = TRUE)
4. do.call(call_fun, call_params)
5. (function (...) 
 . mapply(fun, ..., MoreArgs = NULL, SIMPLIFY = FALSE, USE.NAMES = FALSE))(wb = list(
 .     new("Workbook", .xData = <environment>)), sheetName = c("cluster_NA", 
 . "cluster_NA"))
6. mapply(fun, ..., MoreArgs = NULL, SIMPLIFY = FALSE, USE.NAMES = FALSE)
7. (function (wb, sheetName, gridLines = openxlsx_getOp("gridLines", 
 .     TRUE), tabColour = NULL, zoom = 100, header = openxlsx_getOp("header"), 
 .     footer = openxlsx_getOp("footer"), evenHeader = openxlsx_getOp("evenHeader"), 
 .     evenFooter = openxlsx_getOp("evenFooter"), firstHeader = openxlsx_getOp("firstHeader"), 
 .     firstFooter = openxlsx_getOp("firstFooter"), visible = TRUE, 
 .     paperSize = openxlsx_getOp("paperSize", 9), orientation = openxlsx_getOp("orientation", 
 .         "portrait"), vdpi = openxlsx_getOp("vdpi", 300), hdpi = openxlsx_getOp("hdpi", 
 .         300)) 
 . {
 .     od <- getOption("OutDec")
 .     options(OutDec = ".")
 .     on.exit(expr = options(OutDec = od), add = TRUE)
 .     if (inherits(wb, "list")) {
 .         wb <- wb[[1]]
 .     }
 .     if (!inherits(wb, "Workbook")) {
 .         stop("wb must be a Workbok", call. = FALSE)
 .     }
 .     gridLines <- gridLines %||% TRUE
 .     paperSize <- paperSize %||% 9
 .     orientation <- orientation %||% "portrait"
 .     vdpi <- vdpi %||% 300
 .     hdpi <- hdpi %||% 300
 .     if (tolower(sheetName) %in% tolower(wb$sheet_names)) {
 .         stop(paste0("A worksheet by the name '", sheetName, "' already exists! Sheet names must be unique case-insensitive."))
 .     }
 .     if (!is.logical(gridLines) | length(gridLines) > 1) {
 .         stop("gridLines must be a logical of length 1.")
 .     }
 .     if (nchar(sheetName) > 31) {
 .         stop(paste0("sheetName '", sheetName, "' too long! Max length is 31 characters."))
 .     }
 .     if (!is.null(tabColour)) {
 .         tabColour <- validateColour(tabColour, "Invalid tabColour in addWorksheet.")
 .     }
 .     if (!is.numeric(zoom)) {
 .         stop("zoom must be numeric")
 .     }
 .     if (!is.character(sheetName)) {
 .         sheetName <- as.character(sheetName)
 .     }
 .     if (!is.null(header) & length(header) != 3) {
 .         stop("header must have length 3 where elements correspond to positions: left, center, right.")
 .     }
 .     if (!is.null(footer) & length(footer) != 3) {
 .         stop("footer must have length 3 where elements correspond to positions: left, center, right.")
 .     }
 .     if (!is.null(evenHeader) & length(evenHeader) != 3) {
 .         stop("evenHeader must have length 3 where elements correspond to positions: left, center, right.")
 .     }
 .     if (!is.null(evenFooter) & length(evenFooter) != 3) {
 .         stop("evenFooter must have length 3 where elements correspond to positions: left, center, right.")
 .     }
 .     if (!is.null(firstHeader) & length(firstHeader) != 3) {
 .         stop("firstHeader must have length 3 where elements correspond to positions: left, center, right.")
 .     }
 .     if (!is.null(firstFooter) & length(firstFooter) != 3) {
 .         stop("firstFooter must have length 3 where elements correspond to positions: left, center, right.")
 .     }
 .     visible <- tolower(visible[1])
 .     if (!visible %in% c("true", "false", "hidden", "visible", 
 .         "veryhidden")) {
 .         stop("visible must be one of: TRUE, FALSE, 'hidden', 'visible', 'veryHidden'")
 .     }
 .     orientation <- tolower(orientation)
 .     if (!orientation %in% c("portrait", "landscape")) {
 .         stop("orientation must be 'portrait' or 'landscape'.")
 .     }
 .     vdpi <- as.integer(vdpi)
 .     if (is.na(vdpi)) {
 .         stop("vdpi must be numeric")
 .     }
 .     hdpi <- as.integer(hdpi)
 .     if (is.na(hdpi)) {
 .         stop("hdpi must be numeric")
 .     }
 .     sheetName <- replaceIllegalCharacters(sheetName)
 .     invisible(wb$addWorksheet(sheetName = sheetName, showGridLines = gridLines, 
 .         tabColour = tabColour, zoom = zoom[1], oddHeader = headerFooterSub(header), 
 .         oddFooter = headerFooterSub(footer), evenHeader = headerFooterSub(evenHeader), 
 .         evenFooter = headerFooterSub(evenFooter), firstHeader = headerFooterSub(firstHeader), 
 .         firstFooter = headerFooterSub(firstFooter), visible = visible, 
 .         paperSize = paperSize, orientation = orientation, vdpi = vdpi, 
 .         hdpi = hdpi))
 . })(wb = dots[[1L]][[1L]], sheetName = dots[[2L]][[2L]])
8. stop(paste0("A worksheet by the name '", sheetName, "' already exists! Sheet names must be unique case-insensitive."))
ERROR: Error in (function (wb, sheetName, gridLines = openxlsx_getOp("gridLines", : A worksheet by the name 'cluster_NA' already exists! Sheet names must be unique case-insensitive.


